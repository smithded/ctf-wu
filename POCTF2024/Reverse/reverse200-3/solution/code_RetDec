//
// This file was generated by the Retargetable Decompiler
// Website: https://retdec.com
//

#include <stdint.h>
#include <stdio.h>
#include <string.h>

// ------------------- Function Prototypes --------------------

int64_t check_input(int64_t * str3);
int64_t reveal_flag(void);
int64_t scramble_memory(int64_t * a1, int64_t a2);

// ------------------------ Functions -------------------------

// Address range: 0x401176 - 0x4011d8
int64_t scramble_memory(int64_t * a1, int64_t a2) {
    uint64_t result = a2 + 0xffffffff & 0xffffffff; // 0x4011cc
    if (result == 0) {
        // 0x4011d4
        return result;
    }
    int32_t v1 = 0; // 0x4011d2
    int64_t v2 = (int64_t)a1; // 0x401194
    char * v3 = (char *)v2; // 0x40119f
    char * v4 = (char *)(v2 + 1); // 0x4011a9
    *v3 = *v4;
    *v4 = *v3;
    v1 += 2;
    int64_t v5 = v1; // 0x4011d2
    while (result > v5) {
        // 0x40118a
        v2 = v5 + (int64_t)a1;
        v3 = (char *)v2;
        v4 = (char *)(v2 + 1);
        *v3 = *v4;
        *v4 = *v3;
        v1 += 2;
        v5 = v1;
    }
    // 0x4011d4
    return result;
}

// Address range: 0x4011d8 - 0x401255
int64_t check_input(int64_t * str3) {
    int64_t str = 0x455443414445522a; // bp-19, 0x4011ee
    int32_t len = strlen((char *)&str); // 0x401200
    int64_t str2; // bp-56, 0x4011d8
    strncpy((char *)&str2, (char *)&str, len + 1);
    uint32_t len2 = strlen((char *)&str2); // 0x401223
    scramble_memory(&str2, (int64_t)len2);
    return strcmp((char *)&str2, (char *)str3) == 0;
}

// Address range: 0x401255 - 0x40126b
int64_t reveal_flag(void) {
    // 0x401255
    return puts("Correct!");
}

// Address range: 0x40126b - 0x40130c
int main(int argc, char ** argv) {
    // 0x40126b
    printf("Enter the correct input: ");
    int64_t v1; // bp-40, 0x40126b
    scanf("%29s", &v1);
    if ((int32_t)check_input(&v1) == 0) {
        // 0x4012f6
        puts("Incorrect input! Try again.");
    } else {
        // 0x4012ea
        reveal_flag();
    }
    // 0x401305
    return 0;
}

// --------------------- Meta-Information ---------------------

// Detected compiler/packer: gcc (12.2.0)
// Detected functions: 4


